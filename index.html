<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calculadora de Ticket, Meta e Conversão</title>

  <style>
    :root{
      --bg:#ffffff;

      /* caixas */
      --panel:#f3f4f6;     /* cinza claro */
      --pill:#e5e7eb;      /* cinza um pouco mais escuro */
      --border:#e5e7eb;

      --text:#111827;
      --muted:#6b7280;

      /* slider */
      --accent:#374151;    /* preenchimento */
      --track:#d1d5db;     /* trilho */
      --thumb:#111827;

      /* destaque */
      --good:#c9ff7a;      /* verde fluorescente claro (meta) */

      --radius:18px;
      --shadow: 0 10px 26px rgba(17,24,39,.06);
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: var(--bg);
      color: var(--text);
      font-weight: 400;
    }

    .wrap{
      max-width: 980px;
      margin: 26px auto;
      padding: 0 16px 30px;
    }

    header{
      text-align:center;
      padding: 14px 8px 18px;
      border-bottom: 1px solid var(--border);
      margin-bottom: 18px;
    }

    h1{
      margin:0;
      font-size: 20px;
      letter-spacing: .2px;
      font-weight: 500; /* sem “peso” */
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      align-items:start;
    }
    @media (max-width: 900px){
      .grid{ grid-template-columns: 1fr; }
    }

    .panel{
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
    }

    .panel-title{
      font-size: 13px;
      letter-spacing: .9px;
      text-transform: uppercase;
      color: var(--muted);
      margin: 0 0 12px;
      font-weight: 500;
    }

    .row{
      padding: 14px 0;
      border-bottom: 1px solid rgba(17,24,39,.08);
    }
    .row:last-child{ border-bottom:0; padding-bottom: 4px; }

    .label-line{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 10px;
    }

    .label{
      font-size: 14px;
      color: var(--text);
      font-weight: 400; /* sem negrito */
    }

    .pill{
      min-width: 112px;
      text-align:right;
      padding: 8px 12px;
      border-radius: 14px;
      background: var(--pill);
      border: 1px solid rgba(17,24,39,.08);
      font-variant-numeric: tabular-nums;
      font-weight: 400; /* sem negrito */
      color: var(--text);
    }

    /* slider fino */
    input[type="range"]{
      width: 100%;
      height: 6px; /* mais fino */
      border-radius: 999px;
      outline: none;
      background: linear-gradient(to right,
        var(--accent) 0%,
        var(--accent) var(--fill, 0%),
        var(--track) var(--fill, 0%),
        var(--track) 100%);
      appearance:none;
      -webkit-appearance:none;
    }
    input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none;
      appearance:none;
      width: 16px;
      height: 16px;
      border-radius: 999px;
      background: #fff;
      border: 3px solid var(--thumb);
      box-shadow: 0 8px 14px rgba(0,0,0,.10);
      cursor: pointer;
    }
    input[type="range"]::-moz-range-thumb{
      width: 16px;
      height: 16px;
      border-radius: 999px;
      background: #fff;
      border: 3px solid var(--thumb);
      box-shadow: 0 8px 14px rgba(0,0,0,.10);
      cursor: pointer;
    }

    .results{
      display:flex;
      flex-direction:column;
      gap: 10px;
    }

    .card{
      background: #ffffff;
      border: 1px solid rgba(17,24,39,.10);
      border-radius: 16px;
      padding: 14px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }

    .k{
      color: var(--muted);
      font-size: 13px;
      font-weight: 400;
    }

    .v{
      color: var(--text);
      font-size: 16px;
      font-variant-numeric: tabular-nums;
      font-weight: 400;
    }

    .card.good{
      background: var(--good);
      border-color: rgba(17,24,39,.10);
    }
    .card.good .k, .card.good .v{ color:#0b1f10; }

    /* FUNIL (SVG) */
    .funnel-wrap{
      background:#ffffff;
      border: 1px solid rgba(17,24,39,.10);
      border-radius: 18px;
      padding: 14px;
    }

    .funnel{
      width: 100%;
      max-width: 420px;
      margin: 0 auto;
      display:block;
    }

    .ftext{
      fill:#111827;
      font-weight: 400;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }
    .fmuted{ fill:#6b7280; }

    .hint{
      margin-top: 10px;
      text-align:center;
      font-size: 12px;
      color: var(--muted);
      font-weight: 400;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <h1>Método Marcelo Reinecken</h1>
    </header>

    <div class="grid">
      <!-- ESQUERDA: PARÂMETROS (barrinhas) -->
      <section class="panel">
        <div class="panel-title">Parâmetros</div>

        <!-- Ticket -->
        <div class="row">
          <div class="label-line">
            <div class="label">Ticket ($)</div>
            <div class="pill" id="vTicket">$ 450</div>
          </div>
          <input id="ticket" type="range" min="50" max="5000" step="50" value="450" />
        </div>

        <!-- Vendas atuais -->
        <div class="row">
          <div class="label-line">
            <div class="label">Vendas atuais</div>
            <div class="pill" id="vVendasAtuais">10</div>
          </div>
          <input id="vendasAtuais" type="range" min="1" max="50" step="1" value="10" />
        </div>

        <!-- Meta de vendas -->
        <div class="row">
          <div class="label-line">
            <div class="label">Meta de vendas</div>
            <div class="pill" id="vMeta">30</div>
          </div>
          <input id="meta" type="range" min="1" max="100" step="1" value="30" />
        </div>

        <!-- Conversão -->
        <div class="row">
          <div class="label-line">
            <div class="label">A cada 20 que chegam, quantos compram?</div>
            <div class="pill" id="vConv">2</div>
          </div>
          <input id="conv" type="range" min="1" max="20" step="1" value="2" />
        </div>

        <div class="hint">Engajamento médio considerado automaticamente: 60%.</div>
      </section>

      <!-- DIREITA: RESULTADOS + FUNIL -->
      <aside class="panel">
        <div class="panel-title">Resultado</div>

        <div class="results">
          <div class="card">
            <div class="k">Faturamento (atual)</div>
            <div class="v" id="rFatAtual">$ 0</div>
          </div>

          <div class="card good">
            <div class="k">Faturamento na meta</div>
            <div class="v" id="rFatMeta">$ 0</div>
          </div>

          <div class="funnel-wrap">
            <!-- Funil desenhado (Chegam / Engajam / Compram) -->
            <svg class="funnel" viewBox="0 0 520 420" role="img" aria-label="Funil de conversão">
              <!-- shapes -->
              <defs>
                <linearGradient id="g1" x1="0" x2="0" y1="0" y2="1">
                  <stop offset="0" stop-color="#f3f4f6"/>
                  <stop offset="1" stop-color="#e5e7eb"/>
                </linearGradient>
                <linearGradient id="g2" x1="0" x2="0" y1="0" y2="1">
                  <stop offset="0" stop-color="#f3f4f6"/>
                  <stop offset="1" stop-color="#e5e7eb"/>
                </linearGradient>
              </defs>

              <!-- Top trapezoid -->
              <polygon points="70,50 450,50 390,175 130,175"
                       fill="url(#g1)" stroke="#9ca3af" stroke-width="6" />

              <!-- Middle trapezoid -->
              <polygon points="130,175 390,175 350,285 170,285"
                       fill="url(#g2)" stroke="#9ca3af" stroke-width="6" />

              <!-- Neck -->
              <polygon points="210,285 310,285 335,365 185,365"
                       fill="#f3f4f6" stroke="#9ca3af" stroke-width="6" />

              <!-- Text blocks -->
              <text x="260" y="92" text-anchor="middle" class="ftext" font-size="44" id="fChegamN">0</text>
              <text x="260" y="140" text-anchor="middle" class="ftext fmuted" font-size="44">Chegam</text>

              <text x="260" y="225" text-anchor="middle" class="ftext" font-size="44" id="fEngajamN">0</text>
              <text x="260" y="272" text-anchor="middle" class="ftext fmuted" font-size="44">Engajam</text>

              <text x="260" y="338" text-anchor="middle" class="ftext" font-size="44" id="fCompramN">0</text>
              <text x="260" y="402" text-anchor="middle" class="ftext fmuted" font-size="44">Compram</text>
            </svg>
          </div>
        </div>
      </aside>
    </div>
  </div>

  <script>
    const el = {
      ticket: document.getElementById('ticket'),
      vendasAtuais: document.getElementById('vendasAtuais'),
      meta: document.getElementById('meta'),
      conv: document.getElementById('conv'),

      vTicket: document.getElementById('vTicket'),
      vVendasAtuais: document.getElementById('vVendasAtuais'),
      vMeta: document.getElementById('vMeta'),
      vConv: document.getElementById('vConv'),

      rFatAtual: document.getElementById('rFatAtual'),
      rFatMeta: document.getElementById('rFatMeta'),

      fChegamN: document.getElementById('fChegamN'),
      fEngajamN: document.getElementById('fEngajamN'),
      fCompramN: document.getElementById('fCompramN'),
    };

    function safeInt(v, fallback){
      const n = Number(v);
      return Number.isFinite(n) ? n : fallback;
    }

    // moeda só com "$"
    function money(n){
      const x = Math.round(Number(n) || 0);
      return '$ ' + x.toLocaleString('en-US'); // 12,345
    }

    function setFill(rangeEl){
      const min = safeInt(rangeEl.min, 0);
      const max = safeInt(rangeEl.max, 1);
      const val = safeInt(rangeEl.value, min);
      const pct = (max === min) ? 0 : ((val - min) / (max - min)) * 100;
      rangeEl.style.setProperty('--fill', pct.toFixed(2) + '%');
    }

    function calc(){
      const ticket = safeInt(el.ticket.value, 50);
      const vendasAtuais = safeInt(el.vendasAtuais.value, 1);
      const metaVendas = safeInt(el.meta.value, 1);
      const compramCada20 = safeInt(el.conv.value, 1); // 1..20

      // exibição dos "pills"
      el.vTicket.textContent = money(ticket);
      el.vVendasAtuais.textContent = String(vendasAtuais);
      el.vMeta.textContent = String(metaVendas);
      el.vConv.textContent = String(compramCada20);

      // faturamentos
      const fatAtual = vendasAtuais * ticket;
      const fatMeta = metaVendas * ticket;

      el.rFatAtual.textContent = money(fatAtual);
      el.rFatMeta.textContent = money(fatMeta);

      // conversão: a cada 20 chegam, compram X => taxa = X/20
      const taxaCompra = compramCada20 / 20;

      // pessoas que precisam chegar para bater metaVendas
      // chega = meta / taxa (arredonda pra cima)
      const chegam = Math.ceil(metaVendas / Math.max(taxaCompra, 1e-9));

      // engajam = 60% dos que chegam
      const engajam = Math.round(chegam * 0.60);

      // compram = meta
      const compram = metaVendas;

      // funil (números)
      el.fChegamN.textContent = String(chegam);
      el.fEngajamN.textContent = String(engajam);
      el.fCompramN.textContent = String(compram);

      // fill sliders
      [el.ticket, el.vendasAtuais, el.meta, el.conv].forEach(setFill);
    }

    [el.ticket, el.vendasAtuais, el.meta, el.conv].forEach(r => {
      r.addEventListener('input', calc);
      setFill(r);
    });

    calc();
  </script>
</body>
</html>

<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calculadora de Ticket, Meta e Conversão</title>

  <style>
    :root{
      --bg:#ffffff;

      --panel:#f3f4f6;     /* cinza claro (caixas) */
      --border:#e5e7eb;

      --text:#111827;
      --muted:#6b7280;

      --pill:#e1e5ea;      /* cinza um pouco mais escuro (caixinha de valor) */
      --pillText:#111827;

      --accent:#374151;    /* slider fill */
      --track:#e5e7eb;     /* slider track */
      --thumb:#111827;

      --goodbg:#e9fff0;     /* verde bem claro (faturamento atual) */
      --goodborder:#b7f7c7;
      --goodtext:#0f6a2f;

      --radius:18px;
      --shadow: 0 10px 26px rgba(17,24,39,.08);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: var(--bg);
      color: var(--text);
    }

    .wrap{
      max-width: 980px;
      margin: 24px auto;
      padding: 0 16px 28px;
    }

    header{
      text-align:center;
      padding: 10px 0 16px;
      border-bottom: 1px solid var(--border);
      margin-bottom: 18px;
    }
    header h1{
      margin:0;
      font-size: 22px;
      font-weight: 900;
      letter-spacing: .2px;
    }

    .panel{
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
    }

    .panel + .panel{ margin-top: 14px; }

    .panel h2{
      margin: 0 0 12px;
      font-size: 13px;
      letter-spacing:.8px;
      text-transform: uppercase;
      color: #111827;
    }

    .row{
      padding: 12px 0;
      border-bottom: 1px solid rgba(17,24,39,.08);
    }
    .row:last-child{ border-bottom: 0; padding-bottom: 4px; }

    .label-line{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      margin-bottom: 10px;
    }

    .label{
      font-size: 16px;
      font-weight: 900;
      color: #111827;
    }

    .pill{
      min-width: 110px;
      text-align:right;
      padding: 8px 12px;
      border-radius: 14px;
      background: var(--pill);
      border: 1px solid rgba(17,24,39,.08);
      color: var(--pillText);
      font-weight: 900;
      font-variant-numeric: tabular-nums;
    }

    /* Slider */
    input[type="range"]{
      width: 100%;
      height: 10px;
      border-radius: 999px;
      outline: none;
      background: linear-gradient(to right,
        var(--accent) 0%,
        var(--accent) var(--fill, 50%),
        var(--track) var(--fill, 50%),
        var(--track) 100%);
      appearance:none;
      -webkit-appearance:none;
    }

    input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none;
      appearance:none;
      width: 20px;
      height: 20px;
      border-radius: 999px;
      background: #fff;
      border: 4px solid var(--thumb);
      box-shadow: 0 10px 20px rgba(0,0,0,.14);
      cursor: pointer;
    }
    input[type="range"]::-moz-range-thumb{
      width: 20px;
      height: 20px;
      border-radius: 999px;
      background: #fff;
      border: 4px solid var(--thumb);
      box-shadow: 0 10px 20px rgba(0,0,0,.14);
      cursor: pointer;
    }

    .sub{
      margin-top: 6px;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
    }

    /* Result cards */
    .resultCard{
      background: #ffffff;
      border: 1px solid rgba(17,24,39,.10);
      border-radius: 16px;
      padding: 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }

    .resultCard .k{
      font-weight: 900;
      font-size: 16px;
      color:#111827;
    }
    .resultCard .v{
      font-weight: 900;
      font-size: 18px;
      font-variant-numeric: tabular-nums;
      color:#111827;
    }

    .resultCard.good{
      background: var(--goodbg);
      border-color: var(--goodborder);
    }
    .resultCard.good .k,
    .resultCard.good .v{
      color: var(--goodtext);
    }

    /* Funnel area */
    .funnelWrap{
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin-top: 12px;
    }

    .miniList{
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }

    .miniRow{
      background:#ffffff;
      border: 1px solid rgba(17,24,39,.10);
      border-radius: 16px;
      padding: 12px 14px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 12px;
    }
    .miniRow .k{
      font-weight: 900;
      color:#111827;
    }
    .miniRow .v{
      font-weight: 900;
      font-variant-numeric: tabular-nums;
      color:#111827;
      font-size: 18px;
    }

    /* SVG funnel card */
    .funnelCard{
      background:#ffffff;
      border: 1px solid rgba(17,24,39,.10);
      border-radius: 16px;
      padding: 12px;
      overflow:hidden;
    }

    .hint{
      margin-top: 6px;
      color: var(--muted);
      font-size: 12px;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <h1>Calculadora de Ticket, Meta e Conversão</h1>
    </header>

    <!-- ENTRADAS / PARÂMETROS -->
    <section class="panel">
      <h2>Parâmetros</h2>

      <!-- 1) Ticket -->
      <div class="row">
        <div class="label-line">
          <div class="label">Ticket (R$)</div>
          <div class="pill" id="vTicket">R$ 450</div>
        </div>
        <input id="ticket" type="range" min="50" max="5000" step="50" value="450" />
        <div class="sub">Sobe de 50 em 50 (de 50 até 5.000).</div>
      </div>

      <!-- 2) Vendas atuais -->
      <div class="row">
        <div class="label-line">
          <div class="label">Vendas atuais</div>
          <div class="pill" id="vVendasAtuais">10</div>
        </div>
        <input id="vendasAtuais" type="range" min="1" max="50" step="1" value="10" />
      </div>

      <!-- 3) Faturamento (verde claro) -->
      <div class="row">
        <div class="resultCard good">
          <div class="k">Faturamento</div>
          <div class="v" id="rFatAtual">R$ 0</div>
        </div>
      </div>

      <!-- 4) Meta de vendas -->
      <div class="row">
        <div class="label-line">
          <div class="label">Meta de vendas</div>
          <div class="pill" id="vMetaVendas">30</div>
        </div>
        <input id="metaVendas" type="range" min="1" max="100" step="1" value="30" />
      </div>

      <!-- 5) Faturamento na meta -->
      <div class="row">
        <div class="resultCard">
          <div class="k">Faturamento na meta</div>
          <div class="v" id="rFatMeta">R$ 0</div>
        </div>
      </div>

      <!-- 6) A cada 20 que chegam, quantos compram? (1 a 20) -->
      <div class="row">
        <div class="label-line">
          <div class="label">A cada 20 que chegam, quantos compram?</div>
          <div class="pill" id="vCompramPor20">2</div>
        </div>
        <input id="compramPor20" type="range" min="1" max="20" step="1" value="2" />
        <div class="sub">Ex.: 2 = 2 compras a cada 20 pessoas que chegam.</div>
        <div class="sub"><b>Engajamento médio considerado automaticamente: 60%.</b></div>
      </div>
    </section>

    <!-- RESULTADO / FUNIL -->
    <section class="panel">
      <h2>Funil</h2>

      <div class="funnelWrap">
        <div class="miniList">
          <div class="miniRow">
            <div class="k">Quantas pessoas precisam chegar</div>
            <div class="v" id="rChegam">0</div>
          </div>

          <div class="miniRow">
            <div class="k">Quantas pessoas engajam (60%)</div>
            <div class="v" id="rEngajam">0</div>
          </div>

          <div class="miniRow">
            <div class="k">Compram</div>
            <div class="v" id="rCompram">0</div>
          </div>
        </div>

        <!-- Funil visual -->
        <div class="funnelCard">
          <svg viewBox="0 0 700 520" width="100%" height="auto" aria-label="Funil">
            <!-- fundo -->
            <rect x="0" y="0" width="700" height="520" rx="18" fill="#ffffff"/>

            <!-- funil externo -->
            <path d="M120 60 L580 60 L450 380 L250 380 Z"
                  fill="#f3f4f6" stroke="#111827" stroke-opacity=".25" stroke-width="6" />

            <!-- divisões -->
            <line x1="165" y1="175" x2="535" y2="175" stroke="#111827" stroke-opacity=".25" stroke-width="6" />
            <line x1="210" y1="290" x2="490" y2="290" stroke="#111827" stroke-opacity=".25" stroke-width="6" />

            <!-- bico -->
            <path d="M315 380 L385 380 L405 465 L295 465 Z"
                  fill="#f3f4f6" stroke="#111827" stroke-opacity=".25" stroke-width="6" />

            <!-- textos -->
            <text x="350" y="135" text-anchor="middle" font-size="44" font-weight="900" fill="#111827" opacity=".70">
              Chegam
            </text>
            <text id="svgChegam" x="350" y="95" text-anchor="middle" font-size="44" font-weight="900" fill="#111827">
              0
            </text>

            <text x="350" y="250" text-anchor="middle" font-size="44" font-weight="900" fill="#111827" opacity=".70">
              Engajam
            </text>
            <text id="svgEngajam" x="350" y="210" text-anchor="middle" font-size="44" font-weight="900" fill="#111827">
              0
            </text>

            <text x="350" y="505" text-anchor="middle" font-size="44" font-weight="900" fill="#7c2d12" opacity=".85">
              Compram
            </text>
            <text id="svgCompram" x="350" y="420" text-anchor="middle" font-size="54" font-weight="900" fill="#7c2d12">
              0
            </text>
          </svg>

          <div class="hint">Ordem: Chegam → Engajam → Compram.</div>
        </div>
      </div>
    </section>
  </div>

  <script>
    const el = {
      ticket: document.getElementById('ticket'),
      vendasAtuais: document.getElementById('vendasAtuais'),
      metaVendas: document.getElementById('metaVendas'),
      compramPor20: document.getElementById('compramPor20'),

      vTicket: document.getElementById('vTicket'),
      vVendasAtuais: document.getElementById('vVendasAtuais'),
      vMetaVendas: document.getElementById('vMetaVendas'),
      vCompramPor20: document.getElementById('vCompramPor20'),

      rFatAtual: document.getElementById('rFatAtual'),
      rFatMeta: document.getElementById('rFatMeta'),

      rChegam: document.getElementById('rChegam'),
      rEngajam: document.getElementById('rEngajam'),
      rCompram: document.getElementById('rCompram'),

      svgChegam: document.getElementById('svgChegam'),
      svgEngajam: document.getElementById('svgEngajam'),
      svgCompram: document.getElementById('svgCompram')
    };

    const brl0 = new Intl.NumberFormat('pt-BR', { style:'currency', currency:'BRL', maximumFractionDigits: 0 });

    function clampInt(n, min, max){
      if (!Number.isFinite(n)) return min;
      n = Math.round(n);
      return Math.min(max, Math.max(min, n));
    }

    function setFill(rangeEl){
      const min = Number(rangeEl.min);
      const max = Number(rangeEl.max);
      const val = Number(rangeEl.value);
      const pct = (max === min) ? 0 : ((val - min) / (max - min)) * 100;
      rangeEl.style.setProperty('--fill', pct.toFixed(2) + '%');
    }

    function read(){
      const ticket = clampInt(Number(el.ticket.value), 50, 5000);
      const vendasAtuais = clampInt(Number(el.vendasAtuais.value), 1, 50);
      const metaVendas = clampInt(Number(el.metaVendas.value), 1, 100);
      const compramPor20 = clampInt(Number(el.compramPor20.value), 1, 20);

      // garante que o DOM sempre fique com valores válidos (zero NaN)
      el.ticket.value = ticket;
      el.vendasAtuais.value = vendasAtuais;
      el.metaVendas.value = metaVendas;
      el.compramPor20.value = compramPor20;

      return { ticket, vendasAtuais, metaVendas, compramPor20 };
    }

    function calc(){
      const { ticket, vendasAtuais, metaVendas, compramPor20 } = read();

      // mostra valores das "pílulas"
      el.vTicket.textContent = brl0.format(ticket);
      el.vVendasAtuais.textContent = String(vendasAtuais);
      el.vMetaVendas.textContent = String(metaVendas);
      el.vCompramPor20.textContent = String(compramPor20);

      // faturamentos
      const fatAtual = ticket * vendasAtuais;
      const fatMeta = ticket * metaVendas;

      el.rFatAtual.textContent = brl0.format(fatAtual);
      el.rFatMeta.textContent = brl0.format(fatMeta);

      // funil
      const conversao = compramPor20 / 20;   // ex: 2/20 = 0,10
      const chegam = Math.ceil(metaVendas / conversao);   // pessoas necessárias para bater a meta
      const engajam = Math.ceil(chegam * 0.60);           // 60% engajam
      const compram = metaVendas;

      el.rChegam.textContent = String(chegam);
      el.rEngajam.textContent = String(engajam);
      el.rCompram.textContent = String(compram);

      // SVG
      el.svgChegam.textContent = String(chegam);
      el.svgEngajam.textContent = String(engajam);
      el.svgCompram.textContent = String(compram);

      // fill sliders
      [el.ticket, el.vendasAtuais, el.metaVendas, el.compramPor20].forEach(setFill);
    }

    [el.ticket, el.vendasAtuais, el.metaVendas, el.compramPor20].forEach(r => {
      r.addEventListener('input', calc);
      setFill(r);
    });

    calc();
  </script>
</body>
</html>

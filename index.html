<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calculadora de Ticket, Meta e Conversão</title>

  <style>
    :root{
      --bg:#ffffff;

      --panel:#f3f4f6;          /* caixas cinza claro */
      --panel-border:#e5e7eb;

      --valuebox:#e0e4ea;       /* caixinha do valor um pouco mais escura */
      --valuebox-border:#d4d8df;

      --text:#111827;
      --muted:#6b7280;

      --accent:#111827;         /* trilha preenchida */
      --track:#d7dbe2;          /* trilha */
      --thumb:#111827;

      --fat-meta-bg:#fff4b8;    /* amarelo bem claro */
      --fat-meta-border:#f1de8a;

      --shadow: 0 10px 24px rgba(17,24,39,.06);
      --radius:16px;
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: var(--bg);
      color: var(--text);
      font-weight: 400; /* estética mais leve */
    }

    .wrap{
      max-width: 1000px;
      margin: 24px auto;
      padding: 0 14px 28px;
    }

    .topbar{
      padding: 10px 8px 14px;
      border-bottom: 1px solid #eef0f3;
      margin-bottom: 16px;
    }

    .title{
      margin:0;
      font-size: 22px;
      font-weight: 500; /* sem “pesadão” */
      letter-spacing: .2px;
    }

    .panel{
      background: var(--panel);
      border: 1px solid var(--panel-border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
    }

    .panel + .panel{
      margin-top: 14px;
    }

    .section-title{
      margin: 0 0 10px;
      font-size: 12px;
      letter-spacing: .14em;
      text-transform: uppercase;
      color: #1f2937;
      font-weight: 500;
    }

    .row{
      padding: 12px 0;
      border-bottom: 1px solid #e7e9ee;
    }
    .row:last-child{ border-bottom: 0; }

    .label-line{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      margin-bottom: 10px;
    }

    .label{
      font-size: 14px;
      color: #111827;
      font-weight: 400; /* sem negrito */
    }

    .value-pill{
      min-width: 110px;
      text-align: right;
      padding: 8px 12px;
      border-radius: 12px;
      background: var(--valuebox);
      border: 1px solid var(--valuebox-border);
      color: #111827;
      font-variant-numeric: tabular-nums;
      font-weight: 400; /* sem negrito */
    }

    /* Slider fino */
    input[type="range"]{
      width: 100%;
      height: 6px; /* mais fino */
      border-radius: 999px;
      outline: none;
      background: linear-gradient(to right,
        var(--accent) 0%,
        var(--accent) var(--fill, 50%),
        var(--track) var(--fill, 50%),
        var(--track) 100%);
      appearance:none;
      -webkit-appearance:none;
    }

    input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none;
      appearance:none;
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: #fff;
      border: 3px solid var(--thumb);
      box-shadow: 0 6px 14px rgba(0,0,0,.10);
      cursor: pointer;
    }
    input[type="range"]::-moz-range-thumb{
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: #fff;
      border: 3px solid var(--thumb);
      box-shadow: 0 6px 14px rgba(0,0,0,.10);
      cursor: pointer;
    }

    .result-card{
      background: #ffffff; /* faturamento normal branco */
      border: 1px solid #e5e7eb;
      border-radius: 14px;
      padding: 14px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }

    .result-card .k{
      color:#111827;
      font-size: 14px;
      font-weight: 400;
    }
    .result-card .v{
      color:#111827;
      font-size: 16px;
      font-variant-numeric: tabular-nums;
      font-weight: 400;
    }

    .result-card.meta{
      background: var(--fat-meta-bg); /* amarelo bem claro */
      border-color: var(--fat-meta-border);
    }

    .muted-note{
      margin-top: 8px;
      font-size: 13px;
      color: var(--muted);
      font-weight: 400;
    }

    /* Box do funil */
    .funnel-box{
      background: #ffffff;
      border: 1px solid #e5e7eb;
      border-radius: 14px;
      padding: 14px;
    }

    .funnel-wrap{
      display:flex;
      justify-content:center;
      padding: 6px 0 2px;
    }

    svg{
      max-width: 360px;
      width: 100%;
      height: auto;
      display:block;
    }

    /* ===== Caixa de mensagem abaixo do funil ===== */
    .insight-box{
      background:#ffffff;
      border:1px solid #e5e7eb;
      border-radius:14px;
      padding:16px 18px;
      box-shadow: var(--shadow);
      margin-top:16px;
    }
    .insight-box p{
      margin:0;
      font-size:15px;
      line-height:1.5;
      color:#1f2937;
      font-weight:400;
    }
    .insight-box strong{
      font-weight:500;
      color:#111827;
    }

    /* ===== LAYOUT 2 COLUNAS (computador / landscape) ===== */
    .layout{
      display:block;
    }

    @media (min-width: 900px){
      .layout{
        display:grid;
        grid-template-columns: 1fr 1fr; /* esquerda / direita */
        gap: 16px;
        align-items:start;
      }

      /* remove margem-top entre panels (porque o gap do grid cuida disso) */
      .left .panel + .panel,
      .right .panel + .panel{
        margin-top: 16px;
      }

      /* deixa o funil “grudado” no topo do lado direito */
      .right{
        position: sticky;
        top: 18px;
      }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header class="topbar">
      <h1 class="title">Calculadora de Ticket, Meta e Conversão</h1>
    </header>

    <!-- NOVO: container de layout -->
    <div class="layout">
      <!-- ESQUERDA: calculadora -->
      <div class="left">
        <section class="panel">
          <h2 class="section-title">Parâmetros</h2>

          <!-- 1) Ticket -->
          <div class="row">
            <div class="label-line">
              <div class="label">Ticket ($)</div>
              <div class="value-pill" id="vTicket">$ 450</div>
            </div>
            <input id="ticket" type="range" min="50" max="5000" step="50" value="450" />
          </div>

          <!-- 2) Vendas atuais -->
          <div class="row">
            <div class="label-line">
              <div class="label">Vendas atuais</div>
              <div class="value-pill" id="vAtual">10</div>
            </div>
            <input id="atual" type="range" min="1" max="50" step="1" value="10" />
          </div>

          <!-- 3) Resultado: Faturamento (branco) -->
          <div class="row" style="border-bottom:0; padding-bottom:4px;">
            <h2 class="section-title" style="margin-top:10px;">Resultado</h2>
            <div class="result-card">
              <div class="k">Faturamento</div>
              <div class="v" id="rFat">$ 0</div>
            </div>
          </div>
        </section>

        <!-- 4) Meta de vendas -->
        <section class="panel">
          <div class="row">
            <div class="label-line">
              <div class="label">Meta de vendas</div>
              <div class="value-pill" id="vMeta">30</div>
            </div>
            <input id="meta" type="range" min="1" max="100" step="1" value="30" />
          </div>

          <!-- 5) Faturamento na meta (amarelo claro) -->
          <div class="row" style="border-bottom:0;">
            <div class="result-card meta">
              <div class="k">Faturamento na meta</div>
              <div class="v" id="rFatMeta">$ 0</div>
            </div>
          </div>
        </section>

        <!-- 6) Conversão -->
        <section class="panel">
          <div class="row" style="border-bottom:0;">
            <div class="label-line">
              <div class="label">A cada 20 que chegam, quantos compram?</div>
              <div class="value-pill" id="vCompramPor20">2</div>
            </div>
            <input id="compramPor20" type="range" min="1" max="20" step="1" value="2" />
            <div class="muted-note">Engajamento médio considerado automaticamente: 60%.</div>
          </div>
        </section>
      </div>

      <!-- DIREITA: funil -->
      <div class="right">
        <section class="panel">
          <div class="funnel-box">
            <div class="funnel-wrap">
              <svg viewBox="0 0 360 420" aria-label="Funil de vendas">
                <!-- 1) Chegam -->
                <polygon
                  points="70,70 290,70 270,150 90,150"
                  fill="#e9e9e9"
                  stroke="#111"
                  stroke-width="1"
                  stroke-linejoin="round"
                />
                <text id="nChegam" x="180" y="110"
                      text-anchor="middle"
                      font-size="28"
                      fill="#111827"
                      font-weight="400">0</text>
                <text x="180" y="132"
                      text-anchor="middle"
                      font-size="18"
                      fill="#8b8b8b"
                      font-weight="400">Chegam</text>

                <!-- gap (bem menor, 2 linhas) -->
                <line x1="92" y1="154" x2="268" y2="154" stroke="#111" stroke-width="1" />
                <line x1="92" y1="156" x2="268" y2="156" stroke="#111" stroke-width="1" />

                <!-- 2) Engajam -->
                <polygon
                  points="90,160 270,160 255,240 105,240"
                  fill="#e9e9e9"
                  stroke="#111"
                  stroke-width="1"
                  stroke-linejoin="round"
                />
                <text id="nEngajam" x="180" y="202"
                      text-anchor="middle"
                      font-size="28"
                      fill="#111827"
                      font-weight="400">0</text>
                <text x="180" y="224"
                      text-anchor="middle"
                      font-size="18"
                      fill="#8b8b8b"
                      font-weight="400">Engajam</text>

                <!-- gap (bem menor, 2 linhas) -->
                <line x1="110" y1="246" x2="250" y2="246" stroke="#111" stroke-width="1" />
                <line x1="110" y1="248" x2="250" y2="248" stroke="#111" stroke-width="1" />

                <!-- 3) Compram -->
                <polygon
                  points="120,252 240,252 230,310 130,310"
                  fill="#e9e9e9"
                  stroke="#111"
                  stroke-width="1"
                  stroke-linejoin="round"
                />
                <text id="nCompram" x="180" y="285"
                      text-anchor="middle"
                      font-size="30"
                      fill="#b24a4a"
                      font-weight="400">0</text>
                <text x="180" y="306"
                      text-anchor="middle"
                      font-size="18"
                      fill="#8b8b8b"
                      font-weight="400">Compram</text>
              </svg>
            </div>
          </div>

          <!-- Caixa com a frase (abaixo do funil) -->
          <div class="insight-box">
            <p id="funnelInsight">
              Isso significa que, trazendo cerca de <strong>0</strong> pessoas para o topo do funil, conseguimos sustentar <strong>0</strong> vendas de forma previsível.
            </p>
          </div>
        </section>
      </div>
    </div>
  </div>

  <script>
    const el = {
      ticket: document.getElementById('ticket'),
      atual: document.getElementById('atual'),
      meta: document.getElementById('meta'),
      compramPor20: document.getElementById('compramPor20'),

      vTicket: document.getElementById('vTicket'),
      vAtual: document.getElementById('vAtual'),
      vMeta: document.getElementById('vMeta'),
      vCompramPor20: document.getElementById('vCompramPor20'),

      rFat: document.getElementById('rFat'),
      rFatMeta: document.getElementById('rFatMeta'),

      nChegam: document.getElementById('nChegam'),
      nEngajam: document.getElementById('nEngajam'),
      nCompram: document.getElementById('nCompram'),

      funnelInsight: document.getElementById('funnelInsight')
    };

    const ENG = 0.60; // engajamento fixo 60%

    function formatMoneyUSD(n){
      // Formato: $ 13,500 (sem centavos)
      const x = Math.round(Number(n) || 0);
      return '$ ' + x.toLocaleString('en-US');
    }

    function setFill(rangeEl){
      const min = Number(rangeEl.min);
      const max = Number(rangeEl.max);
      const val = Number(rangeEl.value);
      const pct = (max === min) ? 0 : ((val - min) / (max - min)) * 100;
      rangeEl.style.setProperty('--fill', pct.toFixed(2) + '%');
    }

    function read(){
      return {
        ticket: Number(el.ticket.value),
        atual: Number(el.atual.value),
        meta: Number(el.meta.value),
        compramPor20: Number(el.compramPor20.value)
      };
    }

    function calc(){
      const { ticket, atual, meta, compramPor20 } = read();

      // UI values
      el.vTicket.textContent = formatMoneyUSD(ticket);
      el.vAtual.textContent = String(atual);
      el.vMeta.textContent = String(meta);
      el.vCompramPor20.textContent = String(compramPor20);

      // Faturamentos
      const fat = atual * ticket;
      const fatMeta = meta * ticket;

      el.rFat.textContent = formatMoneyUSD(fat);
      el.rFatMeta.textContent = formatMoneyUSD(fatMeta);

      // Conversão: a cada 20 que chegam, compramPor20 compram
      const conv = Math.max(0, Math.min(1, compramPor20 / 20));

      // Pessoas que precisam chegar para bater a meta
      const chegam = (conv > 0) ? Math.ceil(meta / conv) : 0;

      // Engajam = 60% de quem chega, mas NUNCA pode ser menor que compram
      let engajam = Math.ceil(chegam * ENG);
      if (engajam < meta) engajam = meta;
      if (engajam > chegam) engajam = chegam;

      // Compram = meta
      const compram = meta;

      // Atualiza funil
      el.nChegam.textContent = String(chegam);
      el.nEngajam.textContent = String(engajam);
      el.nCompram.textContent = String(compram);

      // Atualiza mensagem
      if (el.funnelInsight){
        el.funnelInsight.innerHTML =
          `Isso significa que, trazendo cerca de <strong>${chegam}</strong> pessoas para o topo do funil, conseguimos sustentar <strong>${compram}</strong> vendas de forma previsível.`;
      }

      // fill sliders
      [el.ticket, el.atual, el.meta, el.compramPor20].forEach(setFill);
    }

    [el.ticket, el.atual, el.meta, el.compramPor20].forEach((r) => {
      r.addEventListener('input', calc);
      setFill(r);
    });

    calc();
  </script>
</body>
</html>
